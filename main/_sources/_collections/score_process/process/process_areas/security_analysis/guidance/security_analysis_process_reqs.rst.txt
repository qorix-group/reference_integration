..
   # *******************************************************************************
   # Copyright (c) 2025 Contributors to the Eclipse Foundation
   #
   # See the NOTICE file(s) distributed with this work for additional
   # information regarding copyright ownership.
   #
   # This program and the accompanying materials are made available under the
   # terms of the Apache License Version 2.0 which is available at
   # https://www.apache.org/licenses/LICENSE-2.0
   #
   # SPDX-License-Identifier: Apache-2.0
   # *******************************************************************************

   # Some portions generated by Co-Pilot

.. _process_requirements_security_analysis:

Security Analysis Process Requirements
======================================

.. note:: Security Analysis is used as an umbrella term.

.. gd_req:: Security Analysis Structure
   :id: gd_req__sec_structure
   :status: valid
   :tags: done_automation, security_analysis
   :satisfies: wf__analyse_sec_platform_featarch, wf__analyse_sec_featarch, wf__analyse_sec_comparch
   :complies:

   Security Analysis shall be hierarchically grouped into different levels.

   Following levels are defined:

      * Platform
      * Feature
      * Component

.. _process_requirements_security_analysis_attributes:

Process Security Analysis Attributes
------------------------------------

.. gd_req:: Security Analysis attribute: UID
   :id: gd_req__sec_attr_uid
   :status: valid
   :tags: done_automation, attribute, mandatory
   :satisfies: wf__analyse_sec_platform_featarch, wf__analyse_sec_featarch, wf__analyse_sec_comparch
   :complies:

   Each Security Analysis shall have a unique ID. It shall be in a format which is also human readable and consists of

      * Type of Security Analysis
      * Name of analyzed structural element (e.g. Persistency, FEO, etc.)
      * Element descriptor (e.g. KVS__Open KVS or KVS__GetKeyValue)

   The naming convention shall be defined in the project and shall be used consistently.

.. gd_req:: Security Analysis attribute: title
   :id: gd_req__sec_attr_title
   :status: valid
   :tags: manual_prio_1, attribute, mandatory
   :satisfies: wf__analyse_sec_platform_featarch, wf__analyse_sec_featarch, wf__analyse_sec_comparch
   :complies:

   The title of the Security Analysis shall provide a short summary of the description

.. gd_req:: Security Analysis attribute: mitigated by
   :id: gd_req__sec_attr_mitigated_by
   :status: valid
   :tags: prio_1_automation, attribute, optional
   :satisfies: wf__analyse_sec_platform_featarch, wf__analyse_sec_featarch, wf__analyse_sec_comparch
   :complies:

   Each threat shall have an associated treatment (accept, avoid, reduce, share) or AoU.
   If mitigation has not yet been implemented, do not use this option.
   If status == valid then mitigated_by is mandatory.

.. gd_req:: Security Analysis attribute: mitigation issue
   :id: gd_req__sec_attr_mitigation_issue
   :status: valid
   :tags: prio_1_automation, attribute, optional
   :satisfies: wf__analyse_sec_platform_featarch, wf__analyse_sec_featarch, wf__analyse_sec_comparch
   :complies:

   If a new mitigation is needed link to the issue and keep status invalid until mitigation is sufficient.

.. gd_req:: Security Analysis attribute: sufficient
   :id: gd_req__sec_attr_sufficient
   :status: valid
   :tags: prio_1_automation, attribute, mandatory
   :satisfies: wf__analyse_sec_platform_featarch, wf__analyse_sec_featarch, wf__analyse_sec_comparch
   :complies:

   The mitigation(s) shall be rated as sufficient with <yes> or <no>.
   A mitigation can only be sufficient if a mitigation is linked via the attribute mitigation.

.. gd_req:: Security Analysis content: argument
   :id: gd_req__sec_argument
   :status: valid
   :tags: prio_1_automation, attribute, mandatory
   :satisfies: wf__analyse_sec_platform_featarch, wf__analyse_sec_featarch, wf__analyse_sec_comparch
   :complies:

   The argument shall describe why the mitigation is sufficient or not. If it is not sufficient, the argument shall describe how the mitigation
   can be improved to achieve sufficiency. The argument shall be written in the content.

.. gd_req:: Security Analysis attribute: status
   :id: gd_req__sec_attr_status
   :status: valid
   :tags: prio_1_automation, attribute, mandatory
   :satisfies: wf__analyse_sec_platform_featarch, wf__analyse_sec_featarch, wf__analyse_sec_comparch
   :complies:

   Each Security Analysis shall have the status invalid until the analysis is finished.
   The status shall be set to valid if the analysis is finished and all issues are closed.

.. gd_req:: Security Analysis attribute: threat impact
   :id: gd_req__sec_attr_teffect
   :status: valid
   :tags: prio_1_automation, attribute, mandatory
   :satisfies: wf__analyse_sec_platform_featarch, wf__analyse_sec_featarch, wf__analyse_sec_comparch
   :complies:

   Every Security Analysis shall have a short description of the threat impact
   (e.g. threat leads to unauthorized access of the analyzed element)

.. _process_requirements_security_analysis_linkage:

Security Analysis Linkage
''''''''''''''''''''''''''

.. gd_req:: Security Analysis Linkage check
   :id: gd_req__sec_linkage_check
   :status: valid
   :tags: prio_1_automation, attribute, automated
   :satisfies: wf__analyse_sec_platform_featarch, wf__analyse_sec_featarch, wf__analyse_sec_comparch
   :complies:

   Security Analysis shall be linked to the architecture view on the corresponding level
   via the attribute violates.

.. gd_req:: Security Analysis Linkage
   :id: gd_req__sec_linkage
   :status: valid
   :tags: prio_2_automation, attribute, automated
   :satisfies: wf__analyse_sec_platform_featarch, wf__analyse_sec_featarch, wf__analyse_sec_comparch
   :complies:

   Each Security Analysis shall be automatically linked (inverse direction) to the
   corresponding architecture view via the "violates by" linkage.

.. gd_req:: Security Analysis attribute: check Requirements linkage
   :id: gd_req__sec_attr_requirements_check
   :status: valid
   :tags: prio_1_automation, attribute, automated
   :satisfies: wf__analyse_sec_platform_featarch, wf__analyse_sec_featarch, wf__analyse_sec_comparch
   :complies:

   Security Analysis shall be linked to a requirement on the corresponding level via
   the attribute "mitigated by".

.. gd_req:: Security Analysis attribute: Requirements linkage
   :id: gd_req__sec_attr_requirements
   :status: valid
   :tags: prio_2_automation, attribute, automated
   :satisfies: wf__analyse_sec_platform_featarch, wf__analyse_sec_featarch, wf__analyse_sec_comparch
   :complies:

   Each Security Analysis shall be automatically linked to the corresponding Security
   Requirement via the mitigates linkage.

.. gd_req:: Security Analysis attribute: link to Aou
   :id: gd_req__sec_attr_aou
   :status: valid
   :tags: prio_1_automation, attribute, automated
   :satisfies: wf__analyse_sec_platform_featarch, wf__analyse_sec_featarch, wf__analyse_sec_comparch
   :complies:

   It shall be possible to link AoU.

.. gd_req:: Security Analysis attribute: versioning
   :id: gd_req__sec_attr_ver
   :status: valid
   :tags: prio_2_automation, attribute, automated
   :satisfies: wf__analyse_sec_platform_featarch, wf__analyse_sec_featarch, wf__analyse_sec_comparch
   :complies:

   It shall be possible to detect any differences in mandatory attributes compared to
   the versioning: :need:`gd_req__sec_attr_mandatory`.

.. gd_req:: Security Analysis Linkage status check
   :id: gd_req__sec_linkage_status_check
   :status: valid
   :tags: prio_3_automation, attribute, automated
   :satisfies: wf__analyse_sec_platform_featarch, wf__analyse_sec_featarch, wf__analyse_sec_comparch
   :complies:

   It shall be checked that the Security Analysis can only be linked against valid
   security elements (architecture view, requirement, AoU). A valid security element
   has the attribute 'status == valid' and is security-relevant.

.. _process_requirements_security_analysis_checks:

Security Analysis Checks
'''''''''''''''''''''''''

.. gd_req:: Security Analysis mandatory attributes provided
   :id: gd_req__sec_attr_mandatory
   :status: valid
   :tags: prio_1_automation, attribute, check
   :satisfies: wf__analyse_sec_platform_featarch, wf__analyse_sec_featarch, wf__analyse_sec_comparch
   :complies:

   It shall be checked if all mandatory attributes for each Security Analysis are
   provided by the user. For all Security Analysis following attributes shall be mandatory:

   .. needtable:: Overview mandatory Security Analysis attributes
      :filter: "mandatory" in tags and "attribute" in tags and "security_analysis" in tags and type == "gd_req"
      :style: table
      :columns: title
      :colwidths: 30


.. gd_req:: Security Analysis linkage security
   :id: gd_req__sec_linkage_security
   :status: valid
   :tags: prio_2_automation, attribute, check
   :satisfies: wf__analyse_sec_platform_featarch, wf__analyse_sec_featarch, wf__analyse_sec_comparch
   :complies:

   It shall be checked that Security Analysis can only be linked via mitigate_by against
   <Feature | Component | AoU> Requirements with at least one Requirement with the
   security identifier set that is analyzed and linked via violates.


.. gd_req:: Security Analysis finalization check
   :id: gd_req__sec_finalization_check
   :status: valid
   :tags: prio_2_automation, attribute, automated
   :satisfies: wf__analyse_sec_platform_featarch, wf__analyse_sec_featarch, wf__analyse_sec_comparch
   :complies:

    It shall be checked if all artifacts of the analysis are "valid" and "sufficient".

Threat Scenario Security Process Requirements
=============================================

.. gd_req:: Security Analysis attribute: threat scenario ID
   :id: gd_req__sec_attr_threat_scenario_id
   :status: valid
   :tags: prio_1_automation, attribute, mandatory
   :satisfies: wf__analyse_sec_platform_featarch, wf__analyse_sec_featarch, wf__analyse_sec_comparch
   :complies:

   Each threat scenario used for the Security Analysis shall have a threat scenario ID.
   The threat scenario ID is used to identify the related threat <:need:`gd_guidl__sec_ana_threat_scenarios`>.
   The threat scenario ID links to the corresponding threat scenario which describes
   how a potential attack can occur.


Threat Models Process Requirements
==================================

.. gd_req:: Threat Model attribute: threat ID
   :id: gd_req__sec_attr_stride_threat_id
   :status: valid
   :tags: prio_1_automation, attribute, mandatory
   :satisfies: wf__analyse_sec_featarch, wf__analyse_sec_comparch
   :complies:

   Each threat used for Security Analysis shall have a threat ID. The threat ID is used
   to identify the related threat <:need:`gd_guidl__threat_models_stride`>.
   The threat ID links to the corresponding threat which describes how a potential
   attack can occur.


.. needextend:: docname is not None and "process_areas/security_analysis" in docname
   :+tags: security_analysis
